<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <title>
    Spacemacs怎么创建并配置自己的layer？ |
    
    Dexloper
  </title>
  
    <link rel="shortcut icon" href="/favicon.ico">
    
  
<link rel="stylesheet" href="/css/style.css">

  
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <main class="content">
    <section class="outer">
  <article id="post-Spacemacs怎么创建并配置自己的layer？" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      

<h1 class="article-title" itemprop="name">
  Spacemacs怎么创建并配置自己的layer？
</h1>



    </header>
    

    
    <div class="article-meta">
      <a href="/2021/08/18/Spacemacs%E6%80%8E%E4%B9%88%E5%88%9B%E5%BB%BA%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%87%AA%E5%B7%B1%E7%9A%84layer%EF%BC%9F/" class="article-date">
  <time datetime="2021-08-18T10:32:49.000Z" itemprop="datePublished">2021-08-18</time>
</a>
      
    </div>
    

    
    
    

    <div class="article-entry" itemprop="articleBody">
      
      
      
      <p>Spacemacs默认提供了很多实用的layer，但是也有一些layer并不提供，而我们如果想使用一些包的功能，又想把它写进一个layer里面来避免配置文件杂乱的话，可以试着自己创建一个layer</p>
<span id="more"></span>

<p>声明：这只是创建layer的入门配置！并不会特别的深入，如果要进一步了解，可以查看<a target="_blank" rel="noopener" href="https://www.spacemacs.org/doc/DOCUMENTATION.html" title="Spacemacs官方文档">Spacemacs官方文档</a>！</p>
<p>首先打开emacs，我们可以通过输入<code>m-x configuration-layer/create-layer</code>来创建一个layer，执行这个命令之后通常会先让你选择路径，如果选择默认的private的话，这将会是你的死人的layer，不会被上传到spacemacs中的github仓库，而如果你想让自己的layer上传到github仓库中去来为spacemacs做出自己的贡献的话，可以<a target="_blank" rel="noopener" href="https://www.spacemacs.org/doc/documentation.html#types-of-configuration-layers" title="spacemacs中layer的类型">点击这里</a>进行了解，这里我们选择private。</p>
<p>选择路径之后会要求你输入名字，输入一个自己喜欢或容易记住的名字就可以了，最好不要是某个包的名字。输入完名字之后会问你是否要添加readme文件，如果你会把自己的配置放到网上分享给别人的话，你可以添加，也可以选择不添加。接下来开始编写配置</p>
<p>我这里以一个名叫posframe的layer举例。目的是为了使用ivy-posframe来居中显示minibuffer的一些界面，但是因为要使用到ivy-posframe这个包，所以图方便直接就叫ivy-posframe了。</p>
<p>此时，默认应该会跳转到package.el这个文件，我这里因为名字是posframe，所以这个文件的路径是~/.emacs.d/private/posframe/package.el，我们就在这个文件中编写我们的layer。下面以我的视角为例，来编写layer.</p>
<p>此时映入眼帘的一个语句是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defconst posframe-packages</span><br><span class="line">  &#x27;()</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<p>注：这行代码下面可能会有注释</p>
<p>我们在<code>&#39;()</code>的()中填写这个layer需要的包，例如我需要ivy-posframe这个包，我就这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(defconst posframe-packages</span><br><span class="line">  &#x27;(ivy-posframe)</span><br><span class="line">  )</span><br></pre></td></tr></table></figure>


<p>然后我们在在最底下开始配置我们的layer，首先声明一下，请把下面的layername替换成你自己的layer的名字，把init-packagename中的packagename替换成你自己需要的包的名字。</p>
<p>格式大概如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(defun layername/init-packagename ()</span><br><span class="line">   ;;your code.)</span><br></pre></td></tr></table></figure>

<p>那么如果我要添加ivy-posframe这个包，并使用use-package来安装和配置他，我就应该这样写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(defun posframe/init-ivy-posframe ()</span><br><span class="line">    (use-package ivy-posframe</span><br><span class="line">      :init</span><br><span class="line">      (setq ivy-posframe-display-functions-alist</span><br><span class="line">            &#x27;((swiper             . ivy-posframe-display-at-frame-center)</span><br><span class="line">              (complete-symbol    . ivy-posframe-display-at-point)</span><br><span class="line">              (counsel-m-x        . ivy-posframe-display-at-frame-center)</span><br><span class="line">              (counsel-find-file  . ivy-posframe-display-at-frame-center)</span><br><span class="line">              (ivy-switch-buffer  . ivy-posframe-display-at-frame-center)</span><br><span class="line">              (t                  . ivy-posframe-display-at-frame-center)</span><br><span class="line">              )))</span><br><span class="line">    (ivy-posframe-mode 1))</span><br></pre></td></tr></table></figure>

<p>注意layername和init-packagename中的packagename，我换成了我需要的posframe和ivy-posframe包，然后下面就是我们的配置，关于你需要的包的配置你通常可以在包的官网找到，或者上网搜索一下，我这里只是举个例子。大哥的格式就是这样，<code>defun posframe/init-ivy-posframe ()</code>下面就是你对这个layer的配置</p>
<p>配置完你的layer之后，到你的.spacemacs文件中去，找到<code>dotspacemacs-configuration-layers</code>，然后再下面加上你的layer的名字，最后再重启spacemacs，这个layer应该就会生效了，至此，你已经成创建了一个你自己的layer！</p>
<p>我们只是对spacemacs的layer进行了一些简单的配置，但是关于layer，还有很多复杂繁琐的东西，其中还有更加广阔的天地，我就不在这里一一解释了。读者可以查看<a target="_blank" rel="noopener" href="https://www.spacemacs.org/doc/DOCUMENTATION.html" title="Spacemacs官方文档">Spacemacs官方文档</a>。</p>
<hr>
<p>Emacs是一种生活方式</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://liuzhijun-source.github.io/2021/08/18/Spacemacs%E6%80%8E%E4%B9%88%E5%88%9B%E5%BB%BA%E5%B9%B6%E9%85%8D%E7%BD%AE%E8%87%AA%E5%B7%B1%E7%9A%84layer%EF%BC%9F/" data-id="ckt4jx3it000comsbbjwqdhh8" class="article-share-link">
        分享
      </a>
      
<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Emacs/" rel="tag">Emacs</a></li></ul>

    </footer>

  </div>

  
  
<nav class="article-nav">
  
  <a href="/2021/08/19/Spacemacs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-nav-link">
    <strong class="article-nav-caption">前一篇</strong>
    <div class="article-nav-title">
      
      Spacemacs学习笔记（二）
      
    </div>
  </a>
  
  
  <a href="/2021/08/18/Spacemacs%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-nav-link">
    <strong class="article-nav-caption">后一篇</strong>
    <div class="article-nav-title">Spacemacs学习笔记（一）</div>
  </a>
  
</nav>

  

  
  
  
  

</article>
</section>
    <footer class="footer">
  <div class="outer">
    <div class="float-right">
      <ul class="list-inline">
  
  <li><i class="fe fe-smile-alt"></i> <span id="busuanzi_value_site_uv"></span></li>
  
  <li><i class="fe fe-bookmark"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul>
    </div>
    <ul class="list-inline">
      <li>Dexloper &copy; 2021</li>
      
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>theme  <a target="_blank" rel="noopener" href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
  </div>
</footer>
  </main>
  <aside class="sidebar">
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/hexo.svg" alt="Dexloper"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/gallery">相册</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="搜索">
        <i class="fe fe-search"></i>
        搜索
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="fe fe-feed"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/copybtn.js"></script>





<script src="/js/tocbot.min.js"></script>

<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  });
</script>



<script src="/js/ocean.js"></script>

</body>

</html>